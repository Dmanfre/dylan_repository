---
title: "booker_analysis"
author: "Dylan Manfre"
date: "2023-06-05"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
#libraries
library(tidyverse)
library(janitor)
library(lubridate)

```

```{r}
#loading data


#downloaded 05.23.2023 and has the full year 2021-2022
booker_21_22 <- read_csv("data/new_booker_expenses.csv")
head(booker_21_22)

# DOWNLOADED ON 06.02.2023.... HAS DATA FROM 01.01.2023 TO 03.31.2023
booker_23_24 <- read_csv("data/booker_23_24.csv")
head(booker_23_24)

```

```{r}

#NOTES

- #THERE IS A WAWA IN THE TRAVEL CATEGORY AND A WAWA UNDER THE MEALS CATEGORY.... NEED TO COMBINE THOSE TWO TO GET A TOTAL FOR WAWA.

```

```{r}

#Category totals
categories <- booker_21_22 %>% 
group_by(disbursement_description) %>% 
summarize(total_spent = sum(disbursement_amount)) %>% 
arrange(desc(total_spent))
#Category called Meals, Beverages, Catering - Officially Connected, Meals Refund


perc_categories <- categories %>%
mutate(percent = total_spent / sum(total_spent)*100)

#state totals meals from meals category without Individuals...
total_state_meals <- booker_21_22 %>%
filter(entity_type != "IND", disbursement_description == "MEALS") %>% 
group_by(recipient_state) %>% 
summarize(total_spent = sum(disbursement_amount)) %>% 
arrange(desc(total_spent))
#showing the states totals for the meals category


#trying to get a percentage for NJ...
perc_state <- total_state_meals %>% 
mutate(perc_state = total_spent/sum(total_spent)*100)
#10.1%% of money spent in the meals category came from NJ.

#Showing Booker's meals category for 21-22
meals_total <-  booker_21_22 %>%
filter(entity_type != "IND", disbursement_description == "MEALS") %>%
group_by(recipient_name, recipient_state) %>%
summarize(total_spent = sum(disbursement_amount)) %>% 
arrange(desc(total_spent))

#Where Booker spent money on Meals in NJ
nj_meals <- booker_21_22 %>%
filter(disbursement_description == "MEALS", recipient_state == "NJ") %>%
group_by(recipient_name, recipient_state) %>%
summarize(total_spent = sum(disbursement_amount)) %>% 
arrange(desc(total_spent))

#creating a perc of meals_total
perc_meals <- meals_total %>% 
mutate(perc_meals = total_spent/sum(total_spent))

#creating a perc for wawa in NJ
wawa_nj_meals <- nj_meals %>% 
mutate(perc = total_spent/sum(total_spent)*100)
#dont know why the above code is showing 100% in the perc column... should show 81.9%


wawa_nj_meals <- (418.88/511.53)*100
#shows that in NJ... it received 82%... but I got that number by doing free hand math.


#this is to get a wawa_perc from adding everything in total_spent in meals_total and then isolating wawa.
wawa_perc <- (418.88/4925.67)*100
#shows that wawa received 8.5% of his total meals money... but in NJ alone it received 82%.



```

```{r}
#Showing how many transactions are at each place in the meals category. Not limited by State.
meals_count_21_22 <- booker_21_22 %>% 
filter(recipient_name != "BARAIE, ROBAB", disbursement_description == "MEALS") %>%
group_by(recipient_name) %>% 
count() %>% 
arrange(desc(n))
```


Looking at the 23-24 section now... only has transactions from Jan to March Q!


```{r}
#Categories 23-24
categories_23_23 <- booker_23_24 %>% 
group_by(disbursement_description) %>% 
summarize(total_spent = sum(disbursement_amount)) %>% 
arrange(desc(total_spent))
#Meals is 6349.59


state_meal_23_24<- booker_23_24 %>%
filter(entity_type != "IND", disbursement_description == "MEALS") %>% 
group_by(recipient_state) %>% 
summarize(total_spent = sum(disbursement_amount)) %>% 
arrange(desc(total_spent))
# So far New York is No. 1 in the meals category

#State percentage of the meals category
perc_state_23_24 <- state_meal_23_24 %>% 
mutate(perc_state = total_spent/sum(total_spent)*100)
#NJ is No. 3 at 7.1%.

#NOW LOOKING AT SPECIFIC PLACES WHERE HIS CAMPAIGN SPENT MONEY

booker_23_24 %>% 
filter(entity_type != "IND", disbursement_description == "MEALS") %>%
group_by(recipient_name, recipient_state) %>%
summarize(total_spent = sum(disbursement_amount)) %>% 
arrange(desc(total_spent))
#Whole Foods in Newark NJ is significant because it's right under the TAPInto office and also Swahili Village

#counting the transactions
booker_23_24 %>% 
filter(disbursement_description == "MEALS") %>%
group_by(recipient_name) %>% 
count() %>% 
arrange(desc(n))




```


